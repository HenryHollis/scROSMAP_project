---
title: "Metaboanalyst"
format: html
editor: visual
---

```{r}
require(tidyverse)
require(httr)
```

### Read in translation dict for metaboanalyst

```{r}
trans_dict = readxl::read_xlsx("../metabolic_data/metaboanalyst_trans.xlsx")
#The reason this file is needed is that metaboanalyst does not recognize all of the compound names provided by metabolon. This file was generated in the following way: I took metabolon_data_key HMDB ID's and converted them to compound IDs with MetaboAnalyst. But not all of the compoounds had HMDB IDs. Of these, I converted the pubChem IDs given in the metabolon_data_key to compound names in metaboAnalyst. 
```

### Read metabolite list:

```{r}
cycling_in_CTL = read_csv("../Cyclops_ordering/metabolon/cycling_in_CTL.csv", show_col_types = F)
cycling_in_CTL_BHQ1  = filter(cycling_in_CTL, BHQ < 0.1)

cycling_in_AD = read_csv("../Cyclops_ordering/metabolon/cycling_in_AD.csv",show_col_types = F)
cycling_in_AD_BHQ1 = filter(cycling_in_AD, BHQ < 0.1)

diff_cycling = read_csv("../Cyclops_ordering/metabolon/diff_rhythms_CyclingBHQ1.csv", show_col_types = F)
```

### Merge with trans_dict

```{r}
cycling_CTL = merge(cycling_in_CTL_BHQ1,trans_dict, by.x = "SHORT_NAME", by.y = "SHORT_NAME_Metabolon", suffixes = "_metaboAnalyst")

cycling_AD = merge(cycling_in_CTL_BHQ1, trans_dict, by.x = "SHORT_NAME", by.y = "SHORT_NAME_Metabolon", suffixes = "_metaboAnalyst")

write.table(cycling_CTL, "~/Desktop/ctl_cycling_metabolites.csv", sep = ',', row.names = F)
```

```         
```
