#replace hyphens with spaces
enrichR_res$pathway = str_replace(enrichR_res$pathway,pattern = "-", " ")
#fgsea may have multiple libraries in same file (i.e. Kegg and Hallmark), filter for only libname:
fgsea_res = filter(fgsea_res, grepl(libname, fgsea_res$pathway, ignore.case = T))
#remove the "KEGG_" prefix from fgsea results:
fgsea_res$pathway  = fgsea_res$pathway%>% str_replace("KEGG_", "") %>% str_replace_all("_", " ") %>% tolower()
plot_df = stringdist_join(enrichR_res, fgsea_res,
by = "pathway",
mode = "full",
ignore_case = T,
method = "lv",
max_dist = 1,
distance_col = "dist") %>%
group_by(pathway.x) %>%
slice_min(order_by = dist, n = 1) #only keep top match between fgsea and enrichR
plot_df = filter(plot_df, padj < 0.2 | `Adjusted p-value` < 0.2)
if(fgsea_enrichment == "all"){
print("Using pos and neg enrichment scores")
# Define the number of colors you want in the palette
num_colors = 15
# Create a red-to-blue color palette using RColorBrewer
color_palette = rev(colorRampPalette(brewer.pal(num_colors, "RdYlBu"))(num_colors))
p = ggplot(plot_df, aes(NES, -log10(`Adjusted p-value`), color = -log10(padj), label = str_to_title(pathway.x)))+
geom_point(shape = 16, size = 5, alpha = .7)+
ggrepel::geom_text_repel(max.overlaps = max.overlaps, color = "black", point.padding = point_padding, label.padding = label_padding, box.padding = box_padding )+
scale_x_reverse()+
xlim(0,-3.5)+
ggtitle(str_wrap(title, 25))+
theme_minimal()+
scale_color_gradientn(colors = color_palette, name = "-Log(fGSEA BH.q)")+
# geom_vline(xintercept = 0, linetype = "dashed", color = "grey")+
xlab("fGSEA NES")+
ylab("-Log(enrichR BH.q)")+
theme(
axis.text.x = element_text(size = 14),    # Increase x-axis text size
axis.text.y = element_text(size = 14),    # Increase y-axis text size
axis.title.x = element_text(size = 16),   # Increase x-axis title size
axis.title.y = element_text(size = 16),   # Increase y-axis title size
legend.title = element_text(size = 16)    # Increase legend title size
)
print(p)
return(plot_df)
}
if (fgsea_enrichment == "neg"){
print("Using only negative enrichment scores")
plot_df = filter(plot_df, ES < 0)
}else if(fgsea_enrichment == "pos"){
print("Using only positive enrichment scores")
plot_df = filter(plot_df, ES > 0)
}
p = ggplot(plot_df, aes(-log10(padj), -log10(`Adjusted p-value`), label = str_to_title(pathway.x)))+
geom_point(shape = 16, size = 5, alpha = .4, color = marker_color)+
ggrepel::geom_text_repel(max.overlaps = max.overlaps)+
xlab("-Log(fGSEA BH.q)")+
ylab("-Log(enrichR BH.q)")+
ggtitle(str_wrap(title, 25))+
theme_minimal()
print(p)
return(plot_df)
},
error = function(e){message(e)}
)
}
check_file = function(file_path){
# Check if the file exists
if (!file.exists(file_path)) {
print(paste("File", file_path, "does not exist."))
}
}
plot_cycling_and_dr_cycling= function(downstream_str){
setwd(paste0("../Cyclops_ordering/",downstream_str ))
#CONTRL is cycling
enrichR_cyclingBHQ1AR20_CTL = "enrichR_results/EnrichR_CTLcyclersAR20BHQ1_BCKGRND-EnrichRbackground/CTLcyclersAR20BHQ1_LIBRY-KEGG2021Human_BCKGRND-EnrichRbackground.csv"
check_file(enrichR_cyclingBHQ1AR20_CTL)
fgsea_CTL_cyclers_pranked = "fGSEA/fGSEA_results/CTL_cyclers_minusLogPRanked.csv"
check_file(fgsea_CTL_cyclers_pranked)
plot_fgsea_vs_enrichr(enrichR_cyclingBHQ1AR20_CTL, fgsea_CTL_cyclers_pranked, "Pathways Cycling in CTL (Cycling BHQ1 AR20)", fgsea_enrichment = "pos", marker_color = "#0091ff")
#AD is cycling
enrichR_cyclingBHQ1AR20_AD = "enrichR_results/EnrichR_ADcyclersAR20BHQ1_BCKGRND-EnrichRbackground/ADcyclersAR20BHQ1_LIBRY-KEGG2021Human_BCKGRND-EnrichRbackground.csv"
check_file(enrichR_cyclingBHQ1AR20_AD)
fgsea_AD_cyclers_pranked = "fGSEA/fGSEA_results/AD_cyclers_minusLogPRanked.csv"
check_file(fgsea_AD_cyclers_pranked)
plot_fgsea_vs_enrichr(enrichR_cyclingBHQ1AR20_AD, fgsea_AD_cyclers_pranked, "Pathways Cycing in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "pos", marker_color = "red")
#AD gain cycling
enrichR_gainCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRgainAmpADCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRgainAmpADCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_gainCycling_BHQ1AR20)
fgsea_AD_gain_cyclers25 = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_gain_cyclers25)
plot_fgsea_vs_enrichr(enrichR_gainCycling_BHQ1AR20, fgsea_AD_gain_cyclers25, "Pathways Gain Rhythmicity in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "pos", marker_color = "#D81B60")
enrichR_gainCycling_BHQ1AR1 = "enrichR_results/EnrichR_DRgainAmpADCyclingBHQ1AR1DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1/DRgainAmpADCyclingBHQ1AR1DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1.csv"
check_file(enrichR_gainCycling_BHQ1AR1)
fgsea_AD_gain_cyclers1 = "fGSEA/fGSEA_results/DRgenesAmpRatio1_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_gain_cyclers1)
plot_fgsea_vs_enrichr(enrichR_gainCycling_BHQ1AR1, fgsea_AD_gain_cyclers1, "Pathways Gain Rhythmicity in AD (Cycling BHQ1 AR1)", fgsea_enrichment = "pos",  marker_color = "#D81B60")
#AD lose cycling
enrichR_loseCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRlostAmpADCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRlostAmpADCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_loseCycling_BHQ1AR20)
fgsea_AD_lose_cyclers25 = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_lose_cyclers25)
plot_fgsea_vs_enrichr(enrichR_loseCycling_BHQ1AR20, fgsea_AD_lose_cyclers25, "Pathways Lose Rhythmicity in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "neg", marker_color = "#FE6100")
enrichR_loseCycling_BHQ1AR1 = "enrichR_results/EnrichR_DRlostAmpADCyclingBHQ1AR1DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1/DRlostAmpADCyclingBHQ1AR1DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1.csv"
check_file(enrichR_loseCycling_BHQ1AR1)
fgsea_AD_lose_cyclers1 = "fGSEA/fGSEA_results/DRgenesAmpRatio1_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_lose_cyclers1)
plot_fgsea_vs_enrichr(enrichR_loseCycling_BHQ1AR1, fgsea_AD_lose_cyclers1, "Pathways Lose Rhythmicity in AD (Cycling BHQ1 AR1)", fgsea_enrichment = "neg", marker_color = "#FE6100")
#Both AD gain and lose on same plot
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all")
enrichR_DRCycling_BHQ1AR1 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR1DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1/DRcyclersCyclingBHQ1AR1DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1.csv"
check_file(enrichR_DRCycling_BHQ1AR1)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio1_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR1, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1AR1)", fgsea_enrichment = "all")
}
list.files("../Cyclops_ordering/", pattern = "downstream_output*")
# plot_cycling_and_dr_cycling("downstream_output_Exc3_5")
#I no longer call plot_cycling_and_dr_cycling() for this cell type because I want to look at the ampRatio33 files
downstream_str = "downstream_output_Exc3_5"
setwd(paste0("../Cyclops_ordering/",downstream_str ))
enrichR_DRCycling_BHQ1AR33 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR33DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio33/DRcyclersCyclingBHQ1AR33DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio33.csv"
check_file(enrichR_DRCycling_BHQ1AR33)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR33, fgsea_log_ad_ctl_amp, "Excitatory Neurons 3&5", fgsea_enrichment = "all", max.overlaps = 4)
plot_cycling_and_dr_cycling("downstream_output_Inhib_All")
plot_cycling_and_dr_cycling("downstream_output_Ast_All")
#I set max overlaps to 50 to get the pathways cycling in CTL to show other pathways beside ribo
# plot_cycling_and_dr_cycling("downstream_output_Mglia_All")
downstream_str = "downstream_output_Mglia_All"
setwd(paste0("../Cyclops_ordering/",downstream_str ))
#Both AD gain and lose on same plot
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .25, label_padding = 0.5, box_padding  = 0.7)
plot_fgsea_vs_enrichr = function(enrichR_path, fgsea_path, title,  marker_color = "#000000", libname = "KEGG", fgsea_enrichment = "all", max.overlaps = 10, point_padding = 0.25, label_padding = 0.25, box_padding = 0.25){
tryCatch({
fgsea_res = read_csv(fgsea_path, show_col_types = F)
enrichR_res = read_csv(enrichR_path, show_col_types = F)
#make pathway names lowercase
enrichR_res$pathway = enrichR_res$`Term name` %>% tolower()
#replace hyphens with spaces
enrichR_res$pathway = str_replace(enrichR_res$pathway,pattern = "-", " ")
#fgsea may have multiple libraries in same file (i.e. Kegg and Hallmark), filter for only libname:
fgsea_res = filter(fgsea_res, grepl(libname, fgsea_res$pathway, ignore.case = T))
#remove the "KEGG_" prefix from fgsea results:
fgsea_res$pathway  = fgsea_res$pathway%>% str_replace("KEGG_", "") %>% str_replace_all("_", " ") %>% tolower()
plot_df = stringdist_join(enrichR_res, fgsea_res,
by = "pathway",
mode = "full",
ignore_case = T,
method = "lv",
max_dist = 1,
distance_col = "dist") %>%
group_by(pathway.x) %>%
slice_min(order_by = dist, n = 1) #only keep top match between fgsea and enrichR
plot_df = filter(plot_df, padj < 0.2 | `Adjusted p-value` < 0.2)
if(fgsea_enrichment == "all"){
print("Using pos and neg enrichment scores")
# Define the number of colors you want in the palette
num_colors = 15
# Create a red-to-blue color palette using RColorBrewer
color_palette = rev(colorRampPalette(brewer.pal(num_colors, "RdYlBu"))(num_colors))
p = ggplot(plot_df, aes(NES, -log10(`Adjusted p-value`), color = -log10(padj), label = str_to_title(pathway.x)))+
geom_point(shape = 16, size = 5, alpha = .7)+
ggrepel::geom_text_repel(max.overlaps = max.overlaps, color = "black", point.padding = point_padding, label.padding = label_padding, box.padding = box_padding )+
scale_x_reverse()+
xlim(0,-3.5)+
ggtitle(str_wrap(title, 25))+
theme_minimal()+
scale_color_gradientn(colors = color_palette, name = "fGSEA\n-Log(BH.q)")+
# geom_vline(xintercept = 0, linetype = "dashed", color = "grey")+
xlab("fGSEA NES")+
ylab(" EnrichR -Log(BH.q)")+
theme(
axis.text.x = element_text(size = 14),    # Increase x-axis text size
axis.text.y = element_text(size = 14),    # Increase y-axis text size
axis.title.x = element_text(size = 16),   # Increase x-axis title size
axis.title.y = element_text(size = 16),   # Increase y-axis title size
legend.title = element_text(size = 16)    # Increase legend title size
)
print(p)
return(plot_df)
}
if (fgsea_enrichment == "neg"){
print("Using only negative enrichment scores")
plot_df = filter(plot_df, ES < 0)
}else if(fgsea_enrichment == "pos"){
print("Using only positive enrichment scores")
plot_df = filter(plot_df, ES > 0)
}
p = ggplot(plot_df, aes(-log10(padj), -log10(`Adjusted p-value`), label = str_to_title(pathway.x)))+
geom_point(shape = 16, size = 5, alpha = .4, color = marker_color)+
ggrepel::geom_text_repel(max.overlaps = max.overlaps)+
xlab("-Log(fGSEA BH.q)")+
ylab("-Log(enrichR BH.q)")+
ggtitle(str_wrap(title, 25))+
theme_minimal()
print(p)
return(plot_df)
},
error = function(e){message(e)}
)
}
check_file = function(file_path){
# Check if the file exists
if (!file.exists(file_path)) {
print(paste("File", file_path, "does not exist."))
}
}
plot_cycling_and_dr_cycling= function(downstream_str){
setwd(paste0("../Cyclops_ordering/",downstream_str ))
#CONTRL is cycling
enrichR_cyclingBHQ1AR20_CTL = "enrichR_results/EnrichR_CTLcyclersAR20BHQ1_BCKGRND-EnrichRbackground/CTLcyclersAR20BHQ1_LIBRY-KEGG2021Human_BCKGRND-EnrichRbackground.csv"
check_file(enrichR_cyclingBHQ1AR20_CTL)
fgsea_CTL_cyclers_pranked = "fGSEA/fGSEA_results/CTL_cyclers_minusLogPRanked.csv"
check_file(fgsea_CTL_cyclers_pranked)
plot_fgsea_vs_enrichr(enrichR_cyclingBHQ1AR20_CTL, fgsea_CTL_cyclers_pranked, "Pathways Cycling in CTL (Cycling BHQ1 AR20)", fgsea_enrichment = "pos", marker_color = "#0091ff")
#AD is cycling
enrichR_cyclingBHQ1AR20_AD = "enrichR_results/EnrichR_ADcyclersAR20BHQ1_BCKGRND-EnrichRbackground/ADcyclersAR20BHQ1_LIBRY-KEGG2021Human_BCKGRND-EnrichRbackground.csv"
check_file(enrichR_cyclingBHQ1AR20_AD)
fgsea_AD_cyclers_pranked = "fGSEA/fGSEA_results/AD_cyclers_minusLogPRanked.csv"
check_file(fgsea_AD_cyclers_pranked)
plot_fgsea_vs_enrichr(enrichR_cyclingBHQ1AR20_AD, fgsea_AD_cyclers_pranked, "Pathways Cycing in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "pos", marker_color = "red")
#AD gain cycling
enrichR_gainCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRgainAmpADCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRgainAmpADCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_gainCycling_BHQ1AR20)
fgsea_AD_gain_cyclers25 = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_gain_cyclers25)
plot_fgsea_vs_enrichr(enrichR_gainCycling_BHQ1AR20, fgsea_AD_gain_cyclers25, "Pathways Gain Rhythmicity in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "pos", marker_color = "#D81B60")
enrichR_gainCycling_BHQ1AR1 = "enrichR_results/EnrichR_DRgainAmpADCyclingBHQ1AR1DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1/DRgainAmpADCyclingBHQ1AR1DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1.csv"
check_file(enrichR_gainCycling_BHQ1AR1)
fgsea_AD_gain_cyclers1 = "fGSEA/fGSEA_results/DRgenesAmpRatio1_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_gain_cyclers1)
plot_fgsea_vs_enrichr(enrichR_gainCycling_BHQ1AR1, fgsea_AD_gain_cyclers1, "Pathways Gain Rhythmicity in AD (Cycling BHQ1 AR1)", fgsea_enrichment = "pos",  marker_color = "#D81B60")
#AD lose cycling
enrichR_loseCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRlostAmpADCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRlostAmpADCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_loseCycling_BHQ1AR20)
fgsea_AD_lose_cyclers25 = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_lose_cyclers25)
plot_fgsea_vs_enrichr(enrichR_loseCycling_BHQ1AR20, fgsea_AD_lose_cyclers25, "Pathways Lose Rhythmicity in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "neg", marker_color = "#FE6100")
enrichR_loseCycling_BHQ1AR1 = "enrichR_results/EnrichR_DRlostAmpADCyclingBHQ1AR1DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1/DRlostAmpADCyclingBHQ1AR1DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1.csv"
check_file(enrichR_loseCycling_BHQ1AR1)
fgsea_AD_lose_cyclers1 = "fGSEA/fGSEA_results/DRgenesAmpRatio1_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_lose_cyclers1)
plot_fgsea_vs_enrichr(enrichR_loseCycling_BHQ1AR1, fgsea_AD_lose_cyclers1, "Pathways Lose Rhythmicity in AD (Cycling BHQ1 AR1)", fgsea_enrichment = "neg", marker_color = "#FE6100")
#Both AD gain and lose on same plot
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all")
enrichR_DRCycling_BHQ1AR1 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR1DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1/DRcyclersCyclingBHQ1AR1DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1.csv"
check_file(enrichR_DRCycling_BHQ1AR1)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio1_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR1, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1AR1)", fgsea_enrichment = "all")
}
list.files("../Cyclops_ordering/", pattern = "downstream_output*")
# plot_cycling_and_dr_cycling("downstream_output_Exc3_5")
#I no longer call plot_cycling_and_dr_cycling() for this cell type because I want to look at the ampRatio33 files
downstream_str = "downstream_output_Exc3_5"
setwd(paste0("../Cyclops_ordering/",downstream_str ))
enrichR_DRCycling_BHQ1AR33 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR33DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio33/DRcyclersCyclingBHQ1AR33DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio33.csv"
check_file(enrichR_DRCycling_BHQ1AR33)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR33, fgsea_log_ad_ctl_amp, "Excitatory Neurons 3&5", fgsea_enrichment = "all", max.overlaps = 4)
plot_fgsea_vs_enrichr = function(enrichR_path, fgsea_path, title,  marker_color = "#000000", libname = "KEGG", fgsea_enrichment = "all", max.overlaps = 10, point_padding = 0.25, label_padding = 0.25, box_padding = 0.25){
tryCatch({
fgsea_res = read_csv(fgsea_path, show_col_types = F)
enrichR_res = read_csv(enrichR_path, show_col_types = F)
#make pathway names lowercase
enrichR_res$pathway = enrichR_res$`Term name` %>% tolower()
#replace hyphens with spaces
enrichR_res$pathway = str_replace(enrichR_res$pathway,pattern = "-", " ")
#fgsea may have multiple libraries in same file (i.e. Kegg and Hallmark), filter for only libname:
fgsea_res = filter(fgsea_res, grepl(libname, fgsea_res$pathway, ignore.case = T))
#remove the "KEGG_" prefix from fgsea results:
fgsea_res$pathway  = fgsea_res$pathway%>% str_replace("KEGG_", "") %>% str_replace_all("_", " ") %>% tolower()
plot_df = stringdist_join(enrichR_res, fgsea_res,
by = "pathway",
mode = "full",
ignore_case = T,
method = "lv",
max_dist = 1,
distance_col = "dist") %>%
group_by(pathway.x) %>%
slice_min(order_by = dist, n = 1) #only keep top match between fgsea and enrichR
plot_df = filter(plot_df, padj < 0.2 | `Adjusted p-value` < 0.2)
if(fgsea_enrichment == "all"){
print("Using pos and neg enrichment scores")
# Define the number of colors you want in the palette
num_colors = 15
# Create a red-to-blue color palette using RColorBrewer
color_palette = rev(colorRampPalette(brewer.pal(num_colors, "RdYlBu"))(num_colors))
p = ggplot(plot_df, aes(NES, -log10(`Adjusted p-value`), color = -log10(padj), label = str_to_title(pathway.x)))+
geom_point(shape = 16, size = 5, alpha = .7)+
ggrepel::geom_text_repel(max.overlaps = max.overlaps, color = "black", point.padding = point_padding, label.padding = label_padding, box.padding = box_padding )+
scale_x_reverse()+
xlim(0,-3.5)+
ggtitle(str_wrap(title, 25))+
theme_minimal()+
scale_color_gradientn(colors = color_palette, name = "fGSEA\n-Log(BH.q)")+
# geom_vline(xintercept = 0, linetype = "dashed", color = "grey")+
xlab("fGSEA NES")+
ylab(" EnrichR -Log(BH.q)")+
theme(
axis.text.x = element_text(size = 14),    # Increase x-axis text size
axis.text.y = element_text(size = 14),    # Increase y-axis text size
axis.title.x = element_text(size = 16),   # Increase x-axis title size
axis.title.y = element_text(size = 16),   # Increase y-axis title size
legend.title = element_text(size = 12)    # Increase legend title size
)
print(p)
return(plot_df)
}
if (fgsea_enrichment == "neg"){
print("Using only negative enrichment scores")
plot_df = filter(plot_df, ES < 0)
}else if(fgsea_enrichment == "pos"){
print("Using only positive enrichment scores")
plot_df = filter(plot_df, ES > 0)
}
p = ggplot(plot_df, aes(-log10(padj), -log10(`Adjusted p-value`), label = str_to_title(pathway.x)))+
geom_point(shape = 16, size = 5, alpha = .4, color = marker_color)+
ggrepel::geom_text_repel(max.overlaps = max.overlaps)+
xlab("-Log(fGSEA BH.q)")+
ylab("-Log(enrichR BH.q)")+
ggtitle(str_wrap(title, 25))+
theme_minimal()
print(p)
return(plot_df)
},
error = function(e){message(e)}
)
}
check_file = function(file_path){
# Check if the file exists
if (!file.exists(file_path)) {
print(paste("File", file_path, "does not exist."))
}
}
plot_cycling_and_dr_cycling= function(downstream_str){
setwd(paste0("../Cyclops_ordering/",downstream_str ))
#CONTRL is cycling
enrichR_cyclingBHQ1AR20_CTL = "enrichR_results/EnrichR_CTLcyclersAR20BHQ1_BCKGRND-EnrichRbackground/CTLcyclersAR20BHQ1_LIBRY-KEGG2021Human_BCKGRND-EnrichRbackground.csv"
check_file(enrichR_cyclingBHQ1AR20_CTL)
fgsea_CTL_cyclers_pranked = "fGSEA/fGSEA_results/CTL_cyclers_minusLogPRanked.csv"
check_file(fgsea_CTL_cyclers_pranked)
plot_fgsea_vs_enrichr(enrichR_cyclingBHQ1AR20_CTL, fgsea_CTL_cyclers_pranked, "Pathways Cycling in CTL (Cycling BHQ1 AR20)", fgsea_enrichment = "pos", marker_color = "#0091ff")
#AD is cycling
enrichR_cyclingBHQ1AR20_AD = "enrichR_results/EnrichR_ADcyclersAR20BHQ1_BCKGRND-EnrichRbackground/ADcyclersAR20BHQ1_LIBRY-KEGG2021Human_BCKGRND-EnrichRbackground.csv"
check_file(enrichR_cyclingBHQ1AR20_AD)
fgsea_AD_cyclers_pranked = "fGSEA/fGSEA_results/AD_cyclers_minusLogPRanked.csv"
check_file(fgsea_AD_cyclers_pranked)
plot_fgsea_vs_enrichr(enrichR_cyclingBHQ1AR20_AD, fgsea_AD_cyclers_pranked, "Pathways Cycing in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "pos", marker_color = "red")
#AD gain cycling
enrichR_gainCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRgainAmpADCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRgainAmpADCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_gainCycling_BHQ1AR20)
fgsea_AD_gain_cyclers25 = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_gain_cyclers25)
plot_fgsea_vs_enrichr(enrichR_gainCycling_BHQ1AR20, fgsea_AD_gain_cyclers25, "Pathways Gain Rhythmicity in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "pos", marker_color = "#D81B60")
enrichR_gainCycling_BHQ1AR1 = "enrichR_results/EnrichR_DRgainAmpADCyclingBHQ1AR1DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1/DRgainAmpADCyclingBHQ1AR1DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1.csv"
check_file(enrichR_gainCycling_BHQ1AR1)
fgsea_AD_gain_cyclers1 = "fGSEA/fGSEA_results/DRgenesAmpRatio1_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_gain_cyclers1)
plot_fgsea_vs_enrichr(enrichR_gainCycling_BHQ1AR1, fgsea_AD_gain_cyclers1, "Pathways Gain Rhythmicity in AD (Cycling BHQ1 AR1)", fgsea_enrichment = "pos",  marker_color = "#D81B60")
#AD lose cycling
enrichR_loseCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRlostAmpADCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRlostAmpADCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_loseCycling_BHQ1AR20)
fgsea_AD_lose_cyclers25 = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_lose_cyclers25)
plot_fgsea_vs_enrichr(enrichR_loseCycling_BHQ1AR20, fgsea_AD_lose_cyclers25, "Pathways Lose Rhythmicity in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "neg", marker_color = "#FE6100")
enrichR_loseCycling_BHQ1AR1 = "enrichR_results/EnrichR_DRlostAmpADCyclingBHQ1AR1DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1/DRlostAmpADCyclingBHQ1AR1DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1.csv"
check_file(enrichR_loseCycling_BHQ1AR1)
fgsea_AD_lose_cyclers1 = "fGSEA/fGSEA_results/DRgenesAmpRatio1_Log(AD-CTL)ranked.csv"
check_file(fgsea_AD_lose_cyclers1)
plot_fgsea_vs_enrichr(enrichR_loseCycling_BHQ1AR1, fgsea_AD_lose_cyclers1, "Pathways Lose Rhythmicity in AD (Cycling BHQ1 AR1)", fgsea_enrichment = "neg", marker_color = "#FE6100")
#Both AD gain and lose on same plot
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all")
enrichR_DRCycling_BHQ1AR1 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR1DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1/DRcyclersCyclingBHQ1AR1DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio1.csv"
check_file(enrichR_DRCycling_BHQ1AR1)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio1_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR1, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1AR1)", fgsea_enrichment = "all")
}
list.files("../Cyclops_ordering/", pattern = "downstream_output*")
# plot_cycling_and_dr_cycling("downstream_output_Exc3_5")
#I no longer call plot_cycling_and_dr_cycling() for this cell type because I want to look at the ampRatio33 files
downstream_str = "downstream_output_Exc3_5"
setwd(paste0("../Cyclops_ordering/",downstream_str ))
enrichR_DRCycling_BHQ1AR33 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR33DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio33/DRcyclersCyclingBHQ1AR33DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio33.csv"
check_file(enrichR_DRCycling_BHQ1AR33)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR33, fgsea_log_ad_ctl_amp, "Excitatory Neurons 3&5", fgsea_enrichment = "all", max.overlaps = 4)
plot_cycling_and_dr_cycling("downstream_output_Inhib_All")
plot_cycling_and_dr_cycling("downstream_output_Ast_All")
#I set max overlaps to 50 to get the pathways cycling in CTL to show other pathways beside ribo
# plot_cycling_and_dr_cycling("downstream_output_Mglia_All")
downstream_str = "downstream_output_Mglia_All"
setwd(paste0("../Cyclops_ordering/",downstream_str ))
#Both AD gain and lose on same plot
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .25, label_padding = 0.5, box_padding  = 0.7)
setwd("~/Box Sync/Henry_stuff/AD_project/scROSMAP/scrosmap_covariate_fork/scROSMAP_project/Analysis_scripts/")
setwd("~/Box Sync/Henry_stuff/AD_project/scROSMAP/scrosmap_covariate_fork/scROSMAP_project/Figure_scripts/")
downstream_str = "downstream_output_Exc3_5"
setwd(paste0("../Cyclops_ordering/",downstream_str ))
enrichR_DRCycling_BHQ1AR33 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR33DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio33/DRcyclersCyclingBHQ1AR33DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio33.csv"
check_file(enrichR_DRCycling_BHQ1AR33)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR33, fgsea_log_ad_ctl_amp, "Excitatory Neurons 3&5", fgsea_enrichment = "all", max.overlaps = 4)
setwd("../../Figure_scripts/")
plot_cycling_and_dr_cycling("downstream_output_Inhib_All")
# plot_cycling_and_dr_cycling("downstream_output_Mglia_All")
downstream_str = "downstream_output_Mglia_All"
setwd(paste0("../Cyclops_ordering/",downstream_str ))
#Both AD gain and lose on same plot
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .25, label_padding = 0.5, box_padding  = 0.7)
setwd("../../Figure_scripts/")
# plot_cycling_and_dr_cycling("downstream_output_Mglia_All")
downstream_str = "downstream_output_Mglia_All"
setwd(paste0("../Cyclops_ordering/",downstream_str ))
#Both AD gain and lose on same plot
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .25, label_padding = 0.5, box_padding  = 0.7)
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 7, point_padding = .25, label_padding = 0.5, box_padding  = 0.7)
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .3, label_padding = 0.6, box_padding  = 0.8)
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .3, label_padding = 0.9, box_padding  = 0.8)
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .3, label_padding = 0.9, box_padding  = 01)
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .3, label_padding = 0.9, box_padding  = 1.3)
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .5, label_padding = 0.9, box_padding  = .9)
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .5, label_padding = 1.2, box_padding  = .9)
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .5, label_padding = 3, box_padding  = .9)
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .5, label_padding = 3, box_padding  = 1.5)
enrichR_DRCycling_BHQ1AR20 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR20DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20/DRcyclersCyclingBHQ1AR20DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio20.csv"
check_file(enrichR_DRCycling_BHQ1AR20)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR20, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR20)", fgsea_enrichment = "all", max.overlaps = 10, point_padding = .5, label_padding = 1, box_padding  = 1.5)
downstream_str = "downstream_output_Exc3_5"
setwd(paste0("../Cyclops_ordering/",downstream_str ))
setwd("../../Figure_scripts/")
downstream_str = "downstream_output_Exc3_5"
setwd(paste0("../Cyclops_ordering/",downstream_str ))
enrichR_DRCycling_BHQ1AR33 = "enrichR_results/EnrichR_DRcyclersCyclingBHQ1AR33DRBHQ3_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio33/DRcyclersCyclingBHQ1AR33DRBHQ3_LIBRY-KEGG2021Human_BCKGRND-diffrhythmsCyclingBHQ1AmpRatio33.csv"
check_file(enrichR_DRCycling_BHQ1AR33)
fgsea_log_ad_ctl_amp = "fGSEA/fGSEA_results/DRgenesAmpRatio20_Log(AD-CTL)ranked.csv"
check_file(fgsea_log_ad_ctl_amp)
plot_fgsea_vs_enrichr(enrichR_DRCycling_BHQ1AR33, fgsea_log_ad_ctl_amp, "Differentially Rhythmic Pathways in AD (Cycling BHQ1 AR33)", fgsea_enrichment = "all", max.overlaps = 4)
-log10(7.49e-22)
-log10(7.52e-19)
-log10(7.95065184825336E-07)
-log10(0.0000178959870394899)
-log10(0.0405111370616696)
